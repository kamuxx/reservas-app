<div class="login-container">
  <div class="overlay"></div>

  <div class="login-card">
    <div class="login-header">
      <div class="logo-container">
        <i class="pi pi-user-plus text-3xl"></i>
      </div>
      <h2>Crear Cuenta</h2>
      <p>O <a routerLink="/login">inicia sesión aquí</a></p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      @if (isLoading) {
      <p-progressBar mode="indeterminate" [style]="{'height': '4px', 'margin-bottom': '1rem'}"></p-progressBar>
      }

      <div class="form-field">
        <label for="name">Nombre Completo</label>
        <input pInputText id="name" formControlName="name" placeholder="Juan Pérez" class="w-full" />
        <small *ngIf="name?.invalid && name?.touched" class="p-error">
          @if (name?.errors?.['required']) {
          El nombre es requerido
          }
          @if (name?.errors?.['minlength']) {
          Mínimo 3 caracteres
          }
        </small>
      </div>

      <div class="form-field">
        <label for="email">Correo Electrónico</label>
        <input pInputText id="email" type="email" formControlName="email" placeholder="tu@email.com" class="w-full" />
        <small *ngIf="email?.invalid && email?.touched" class="p-error">
          @if (email?.errors?.['required']) {
          El email es requerido
          }
          @if (email?.errors?.['email']) {
          Formato de email inválido
          }
          @if (email?.errors?.['emailTaken']) {
          Este correo ya está registrado
          }
        </small>
      </div>

      <div class="form-field">
        <label for="phone">Teléfono</label>
        <input pInputText id="phone" formControlName="phone" placeholder="+584121234567" class="w-full" />
        <small *ngIf="phone?.invalid && phone?.touched" class="p-error">
          @if (phone?.errors?.['required']) {
          El teléfono es requerido
          }
          @if (phone?.errors?.['pattern']) {
          Formato inválido. Ej: +584121234567
          }
        </small>
      </div>

      <div class="form-field">
        <label for="password">Contraseña</label>
        <p-password inputId="password" formControlName="password" [toggleMask]="true" [feedback]="false"
          placeholder="Mínimo 8 caracteres" styleClass="w-full" [inputStyle]="{'width':'100%'}"></p-password>
        <small *ngIf="password?.invalid && password?.touched" class="p-error">
          @if (password?.errors?.['required']) {
          La contraseña es requerida
          }
          @if (password?.errors?.['minlength']) {
          Mínimo 8 caracteres
          }
          @if (password?.errors?.['pattern']) {
          Debe incluir mayúscula, minúscula y número
          }
        </small>
      </div>

      <div class="form-field">
        <label for="password_confirmation">Confirmar Contraseña</label>
        <p-password inputId="password_confirmation" formControlName="password_confirmation" [toggleMask]="true"
          [feedback]="false" placeholder="Repite tu contraseña" styleClass="w-full"
          [inputStyle]="{'width':'100%'}"></p-password>
        <small *ngIf="password_confirmation?.invalid && password_confirmation?.touched" class="p-error">
          @if (password_confirmation?.errors?.['required']) {
          Confirma tu contraseña
          }
          @if (password_confirmation?.errors?.['passwordMismatch']) {
          Las contraseñas no coinciden
          }
        </small>
      </div>

      <button pButton type="submit" label="Registrarse" [loading]="isLoading"
        [disabled]="registerForm.invalid || isLoading" class="w-full p-button">
      </button>
    </form>
  </div>

  <p-toast position="top-right"></p-toast>
</div>